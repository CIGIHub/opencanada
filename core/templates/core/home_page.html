{% extends "base.html" %}

{% load static core_tags wagtailcore_tags article_tags wagtailimages_tags %}

{% block body_class %}template-{{ self.get_verbose_name|slugify }}{% endblock %}

{% block feature %}
    {% include 'core/main-feature.html' %}
{% endblock %}


{% block content %}
    <div class="container features" id="features">

        {% for row in self.articles %}
            <div class="row">
            {%  for article in row %}
                <div class="col-sm-{{ row|column_class }} feature-item">
                    {% if article.feature_style.include_image and article.feature_style.overlay_text %}
                        <div class="overlay-feature rowheight-{{ article.feature_style.number_of_rows }}" style="height: {{ article|column_height }}px">
                            {% if article.editors_pick %}
                                <div class="editors-pick"><div>Editors Pick</div></div>
                            {% endif %}
                            {% if article.feature_style.number_of_rows = 2 %}
                                {% image article.main_image fill-910x560 as background_image %}
                            {% else %}
                                {% image article.main_image fill-910x280 as background_image %}
                            {% endif %}
                            <div class="feature-image" style="background-image: url('{{ background_image.url }}')">
                                <div class="feature-image-overlay" style="background: rgba( {{ article.image_overlay_color.rgb }}, {{ article.opacity }} )"></div>
                            </div>
                            <div class="feature-text" style="color: {{ article.font_style.text_colour.hex_value }}">
                                <h2><a style="color: {{ article.font_style.text_colour.hex_value }};" href="{{ article.url }}">{{ article.title }}</a></h2>

                                {% if article.subtitle %}
                                    <div class="feature-line">{{ article.subtitle|richtext }}</div>
                                {% else %}
                                    <div class="feature-line">{{ article.excerpt|richtext }}</div>
                                {% endif %}
                                {% if article.authors %}
                                    <div class="contributors">By:
                                        {% for author in article.authors %}
                                        <div class="contributor">
                                            <a style="color: {{ article.font_style.text_colour.hex_value }}" href="author.url">{{ author.first_name }} {{ author.last_name }}</a>
                                        </div>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                            </div>
                            <div class="image-caption"><i class="fa fa-camera"></i> {{article.main_image.credit }}</div>
                        </div>

                    {% elif article.feature_style.include_image and not article.feature_style.overlay_text %}
                        <div class="image-feature">
                            {% if article.editors_pick %}
                                <div class="editors-pick"><div>Editors Pick</div></div>
                            {% endif %}
                            <figure>{%  image article.main_image fill-710x475 %}</figure>
                            <h2><a href="{{ article.url }}">{{ article.title }}</a></h2>
                               <div class="contributors">By:
                                    {% for author in article.authors %}
                                    <div class="contributor">
                                        <a style="color: {{ article.font_style.text_colour.hex_value }}" href="author.url">{{ author.first_name }} {{ author.last_name }}</a>
                                    </div>
                                    {% endfor %}
                                </div>

                        </div>

                    {% else %}
                        <div class="simple-feature">
                            {% if article.editors_pick %}
                                <div class="editors-pick"><div>Editors Pick</div></div>
                            {% endif %}
                            <h2><a href="{{ article.url }}">{{ article.title }}</a></h2>
                            <div class="contributors">By:
                                {% for author in article.authors %}
                                <div class="contributor">
                                    <a style="color: {{ article.font_style.text_colour.hex_value }}" href="author.url">{{ author.first_name }} {{ author.last_name }}</a>
                                </div>
                                {% endfor %}
                            </div>
                            {% if article.subtitle %}
                                <div class="feature-line">{{ article.subtitle|richtext }}</div>
                            {% else %}
                                <div class="feature-line">{{ article.excerpt|richtext }}</div>
                            {% endif %}
                        </div>
                    {% endif %}
                </div>

                {% endfor %}

            </div>
        {% endfor %}
    </div>

{% endblock %}
